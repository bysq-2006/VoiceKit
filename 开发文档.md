# 语音助手 - 开发文档

> 本文档用于理解项目架构，同时作为 AI 开发基准提示词。

## 项目概述

一个基于 Tauri + Vue3 的桌面语音助手应用，核心设计理念：**状态驱动**——前端只修改状态变量，后端监听状态变化并执行对应工作流。

## 核心原则

```
┌─────────────────────────────────────────────────────────┐
│  前端 (Frontend)                                         │
│  ├── 仅负责 UI 渲染                                      │
│  ├── 仅负责修改状态变量                                  │
│  └── 通过 invoke 修改状态，通过 event 监听后端状态       │
├─────────────────────────────────────────────────────────┤
│  后端 (Backend)                                          │
│  ├── 监听状态变化，自动执行工作流                        │
│  ├── 管理音频缓冲区                                      │
│  ├── 管理文字缓冲区                                      │
│  ├── 调用语音转文字 API（双向流）                        │
│  ├── 模拟键盘输入到当前焦点                              │
│  └── 管理配置存储 (Store)                                │
└─────────────────────────────────────────────────────────┘
```




## 状态流转

```
用户按下快捷键 (如 Shift+E)
        ↓
后端: Global Shortcut Handler 触发
        ↓
前端: 修改 is_recording = true (invoke)
        ↓
后端: StateMonitor 监听到变化
        ↓
后端: AudioRecorder 开始 → 写入 AudioBuffer
        ↓
后端: ASRClient 开始 → 读取 AudioBuffer → 豆包 ASR
        ↓
后端: 豆包 ASR 返回文字 → 写入 TextBuffer
        ↓
后端: InputSimulator 读取 TextBuffer → 模拟键盘输入
        ↓
用户再次按下快捷键
        ↓
前端: 修改 is_recording = false (invoke)
        ↓
后端: StateMonitor 监听到变化
        ↓
后端: AudioRecorder 停止 → AudioBuffer 标记结束
        ↓
后端: ASRClient 处理完剩余音频 → TextBuffer 标记结束
        ↓
后端: InputSimulator 输出完剩余文字 → 停止
```




## 后端